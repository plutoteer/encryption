{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  style: {\n    \"padding\": \"24px\",\n    \"max-width\": \"700px\",\n    \"margin\": \"auto\"\n  }\n};\nconst _hoisted_2 = {\n  key: 0\n};\nconst _hoisted_3 = {\n  key: 0\n};\nconst _hoisted_4 = {\n  key: 1\n};\nconst _hoisted_5 = {\n  style: {\n    \"margin-top\": \"16px\"\n  }\n};\nconst _hoisted_6 = {\n  style: {\n    \"margin-top\": \"16px\"\n  }\n};\nconst _hoisted_7 = {\n  key: 0\n};\nconst _hoisted_8 = {\n  style: {\n    \"margin-top\": \"16px\"\n  }\n};\nconst _hoisted_9 = {\n  key: 0\n};\nconst _hoisted_10 = {\n  style: {\n    \"margin-top\": \"16px\"\n  }\n};\nconst _hoisted_11 = {\n  key: 0\n};\nexport function render(_ctx, _cache) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[17] || (_cache[17] = _createElementVNode(\"h2\", null, \"参与方 WebSocket 连接\", -1 /* CACHED */)), _createElementVNode(\"div\", null, [_cache[10] || (_cache[10] = _createElementVNode(\"label\", null, \"WebSocket 端口: \", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _ctx.wsPort = $event),\n    style: {\n      \"width\": \"80px\"\n    }\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, _ctx.wsPort]]), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => _ctx.connectWS && _ctx.connectWS(...args))\n  }, \"连接\"), _ctx.wsStatus ? (_openBlock(), _createElementBlock(\"span\", _hoisted_2, \"(\" + _toDisplayString(_ctx.wsStatus) + \")\", 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _ctx.ipPush ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_cache[11] || (_cache[11] = _createElementVNode(\"h3\", null, \"本机IP推送\", -1 /* CACHED */)), _createElementVNode(\"div\", null, \"IP: \" + _toDisplayString(_ctx.ipPush.ip) + \" | 端口: \" + _toDisplayString(_ctx.ipPush.port), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true), _ctx.keygenProgress ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_cache[12] || (_cache[12] = _createElementVNode(\"h3\", null, \"密钥生成进度\", -1 /* CACHED */)), _createElementVNode(\"div\", null, \"步骤: \" + _toDisplayString(_ctx.keygenProgress.step), 1 /* TEXT */), _createElementVNode(\"div\", null, \"状态: \" + _toDisplayString(_ctx.keygenProgress.status), 1 /* TEXT */), _createElementVNode(\"div\", null, \"说明: \" + _toDisplayString(_ctx.keygenProgress.message), 1 /* TEXT */), _createElementVNode(\"div\", null, \"时间: \" + _toDisplayString(_ctx.keygenProgress.timestamp), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_5, [_cache[13] || (_cache[13] = _createElementVNode(\"h3\", null, \"发送协调器IP\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => _ctx.coordinatorIP = $event),\n    placeholder: \"输入协调器IP\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, _ctx.coordinatorIP]]), _createElementVNode(\"button\", {\n    onClick: _cache[3] || (_cache[3] = (...args) => _ctx.sendCoordinatorIP && _ctx.sendCoordinatorIP(...args))\n  }, \"发送\")]), _createElementVNode(\"div\", _hoisted_6, [_cache[14] || (_cache[14] = _createElementVNode(\"h3\", null, \"自身状态\", -1 /* CACHED */)), _createElementVNode(\"button\", {\n    onClick: _cache[4] || (_cache[4] = (...args) => _ctx.fetchSelfStatus && _ctx.fetchSelfStatus(...args))\n  }, \"查询\"), _ctx.selfStatus ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [_createElementVNode(\"pre\", null, _toDisplayString(_ctx.selfStatus), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_8, [_cache[15] || (_cache[15] = _createElementVNode(\"h3\", null, \"协同解密/刷新请求\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => _ctx.ciphertext = $event),\n    placeholder: \"密文 ciphertext\",\n    style: {\n      \"width\": \"300px\"\n    }\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, _ctx.ciphertext]]), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => _ctx.targetParticipants = $event),\n    placeholder: \"目标参与方ID,逗号分隔\",\n    style: {\n      \"width\": \"180px\"\n    }\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, _ctx.targetParticipants]]), _createElementVNode(\"button\", {\n    onClick: _cache[7] || (_cache[7] = (...args) => _ctx.collaborativeDecrypt && _ctx.collaborativeDecrypt(...args))\n  }, \"协同解密\"), _createElementVNode(\"button\", {\n    onClick: _cache[8] || (_cache[8] = (...args) => _ctx.collaborativeRefresh && _ctx.collaborativeRefresh(...args))\n  }, \"协同刷新\"), _ctx.collabResp ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [_createElementVNode(\"pre\", null, _toDisplayString(_ctx.collabResp), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_10, [_cache[16] || (_cache[16] = _createElementVNode(\"h3\", null, \"在线状态查询\", -1 /* CACHED */)), _createElementVNode(\"button\", {\n    onClick: _cache[9] || (_cache[9] = (...args) => _ctx.fetchOnlineStatus && _ctx.fetchOnlineStatus(...args))\n  }, \"查询\"), _ctx.onlineStatus ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [_createElementVNode(\"pre\", null, _toDisplayString(_ctx.onlineStatus), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true)])]);\n}","map":{"version":3,"names":["style","_createElementBlock","_hoisted_1","_createElementVNode","_ctx","wsPort","$event","onClick","_cache","args","connectWS","wsStatus","_hoisted_2","_toDisplayString","ipPush","_hoisted_3","ip","port","keygenProgress","_hoisted_4","step","status","message","timestamp","_hoisted_5","coordinatorIP","placeholder","sendCoordinatorIP","_hoisted_6","fetchSelfStatus","selfStatus","_hoisted_7","_hoisted_8","ciphertext","targetParticipants","collaborativeDecrypt","collaborativeRefresh","collabResp","_hoisted_9","_hoisted_10","fetchOnlineStatus","onlineStatus","_hoisted_11"],"sources":["D:\\down\\MPHEDEV\\encryption_par\\src\\App.vue"],"sourcesContent":["<template>\r\n  <div style=\"padding: 24px; max-width: 700px; margin: auto;\">\r\n    <h2>参与方 WebSocket 连接</h2>\r\n    <div>\r\n      <label>WebSocket 端口: </label>\r\n      <input v-model=\"wsPort\" style=\"width: 80px;\" />\r\n      <button @click=\"connectWS\">连接</button>\r\n      <span v-if=\"wsStatus\">({{ wsStatus }})</span>\r\n    </div>\r\n    <div v-if=\"ipPush\">\r\n      <h3>本机IP推送</h3>\r\n      <div>IP: {{ ipPush.ip }} | 端口: {{ ipPush.port }}</div>\r\n    </div>\r\n    <div v-if=\"keygenProgress\">\r\n      <h3>密钥生成进度</h3>\r\n      <div>步骤: {{ keygenProgress.step }}</div>\r\n      <div>状态: {{ keygenProgress.status }}</div>\r\n      <div>说明: {{ keygenProgress.message }}</div>\r\n      <div>时间: {{ keygenProgress.timestamp }}</div>\r\n    </div>\r\n    <div style=\"margin-top: 16px;\">\r\n      <h3>发送协调器IP</h3>\r\n      <input v-model=\"coordinatorIP\" placeholder=\"输入协调器IP\" />\r\n      <button @click=\"sendCoordinatorIP\">发送</button>\r\n    </div>\r\n    <div style=\"margin-top: 16px;\">\r\n      <h3>自身状态</h3>\r\n      <button @click=\"fetchSelfStatus\">查询</button>\r\n      <div v-if=\"selfStatus\">\r\n        <pre>{{ selfStatus }}</pre>\r\n      </div>\r\n    </div>\r\n    <div style=\"margin-top: 16px;\">\r\n      <h3>协同解密/刷新请求</h3>\r\n      <input v-model=\"ciphertext\" placeholder=\"密文 ciphertext\" style=\"width: 300px;\" />\r\n      <input v-model=\"targetParticipants\" placeholder=\"目标参与方ID,逗号分隔\" style=\"width: 180px;\" />\r\n      <button @click=\"collaborativeDecrypt\">协同解密</button>\r\n      <button @click=\"collaborativeRefresh\">协同刷新</button>\r\n      <div v-if=\"collabResp\">\r\n        <pre>{{ collabResp }}</pre>\r\n      </div>\r\n    </div>\r\n    <div style=\"margin-top: 16px;\">\r\n      <h3>在线状态查询</h3>\r\n      <button @click=\"fetchOnlineStatus\">查询</button>\r\n      <div v-if=\"onlineStatus\">\r\n        <pre>{{ onlineStatus }}</pre>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport {\r\n  getSelfStatus,\r\n  getOnlineStatus,\r\n  collaborativeDecrypt,\r\n  collaborativeRefresh\r\n} from './api/participant'\r\n\r\nconst wsPort = ref('8081')\r\nconst ws = ref(null)\r\nconst wsStatus = ref('未连接')\r\nconst ipPush = ref(null)\r\nconst keygenProgress = ref(null)\r\nconst coordinatorIP = ref('')\r\n\r\nfunction connectWS() {\r\n  if (ws.value) ws.value.close()\r\n  ws.value = new WebSocket(`ws://localhost:${wsPort.value}/api/participant/ws`)\r\n  ws.value.onopen = () => { wsStatus.value = '已连接' }\r\n  ws.value.onclose = () => { wsStatus.value = '已断开' }\r\n  ws.value.onerror = () => { wsStatus.value = '连接错误' }\r\n  ws.value.onmessage = (event) => {\r\n    const msg = JSON.parse(event.data)\r\n    if (msg.type === 'ip') {\r\n      ipPush.value = msg\r\n    } else if (msg.type === 'keygen_progress') {\r\n      keygenProgress.value = msg\r\n    }\r\n  }\r\n}\r\n\r\nfunction sendCoordinatorIP() {\r\n  if (ws.value && ws.value.readyState === 1) {\r\n    ws.value.send(JSON.stringify({\r\n      type: 'coordinator_ip',\r\n      coordinator_ip: coordinatorIP.value\r\n    }))\r\n  }\r\n}\r\n\r\n// 自身状态\r\nconst selfStatus = ref('')\r\nasync function fetchSelfStatus() {\r\n  const res = await getSelfStatus(wsPort.value)\r\n  selfStatus.value = JSON.stringify(res.data, null, 2)\r\n}\r\n\r\n// 协同解密/刷新\r\nconst ciphertext = ref('')\r\nconst targetParticipants = ref('')\r\nconst collabResp = ref('')\r\nasync function collaborativeDecrypt() {\r\n  const ids = targetParticipants.value.split(',').map(s => parseInt(s)).filter(Boolean)\r\n  const res = await collaborativeDecryptApi(wsPort.value, {\r\n    ciphertext: ciphertext.value,\r\n    target_participants: ids\r\n  })\r\n  collabResp.value = JSON.stringify(res.data, null, 2)\r\n}\r\nasync function collaborativeRefresh() {\r\n  const ids = targetParticipants.value.split(',').map(s => parseInt(s)).filter(Boolean)\r\n  const res = await collaborativeRefreshApi(wsPort.value, {\r\n    ciphertext: ciphertext.value,\r\n    target_participants: ids\r\n  })\r\n  collabResp.value = JSON.stringify(res.data, null, 2)\r\n}\r\n// 兼容导入\r\nconst collaborativeDecryptApi = collaborativeDecrypt\r\nconst collaborativeRefreshApi = collaborativeRefresh\r\n\r\n// 在线状态\r\nconst onlineStatus = ref('')\r\nasync function fetchOnlineStatus() {\r\n  const res = await getOnlineStatus(wsPort.value)\r\n  onlineStatus.value = JSON.stringify(res.data, null, 2)\r\n}\r\n</script> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}